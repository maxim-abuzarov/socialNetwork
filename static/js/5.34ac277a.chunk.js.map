{"version":3,"sources":["components/users/users.module.css","components/users/searchform.module.css","components/common/paginator/Paginator.tsx","components/users/User.tsx","redux/selectors/usersSelectors.ts","components/users/UsersSearchForm.tsx","components/users/Users.tsx"],"names":["module","exports","Paginator","totalItemsCount","pageSize","currentPage","portionSize","isLoading","onPageChanged","pagesCount","Math","ceil","portionCount","useState","portionNumber","setPortionNumber","leftPortionPageNumber","rightPortionPageNumber","pages","i","push","className","usersClasses","pagesLoading","page","onClick","filter","map","pageSelected","User","user","followingProgress","follow","unfollow","usersLoading","name","toLowerCase","photo","to","id","src","photos","large","avatar","alt","status","button","followed","disabled","some","getUsersInfo","state","usersPage","users","getPageSize","getTotalUsersCount","totalUsersCount","getCurrentPage","getIsLoading","getFollowingProgress","getUsersFilter","UsersSearchForm","React","memo","onFilterChanged","useSelector","searchFormClasses","form","enableReinitialize","initialValues","term","friend","String","onSubmit","values","setSubmitting","isSubmitting","type","placeholder","as","value","Users","dispatch","useDispatch","history","useHistory","useEffect","parsed","queryString","location","search","substr","actualPage","actualFilter","Number","getUsers","query","pathname","followUser","userId","unfollowUser","inner","Loading","pageNumber"],"mappings":"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","file":"static/js/5.34ac277a.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"inner\":\"users_inner__8zw3D\",\"user\":\"users_user__35VOC\",\"usersLoading\":\"users_usersLoading__1Z-K5\",\"name\":\"users_name__Or0kG\",\"photo\":\"users_photo__Z_NMi\",\"status\":\"users_status__HnLT-\",\"button\":\"users_button__2U6vF\",\"followed\":\"users_followed__1INXW\",\"pages\":\"users_pages__2zuKX\",\"pagesLoading\":\"users_pagesLoading__zGKft\",\"page\":\"users_page__1VGXq\",\"pageSelected\":\"users_pageSelected__3AnPR\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"form\":\"searchform_form__3QDMb\"};","import React, {FC, useState} from 'react'\nimport usersClasses from '../../users/users.module.css'\n\ntype PropsType = {\n    totalItemsCount: number\n    pageSize: number\n    currentPage?: number\n    portionSize?: number\n    isLoading: boolean\n    onPageChanged: (pageNumber: number) => void\n}\n\nconst Paginator: FC<PropsType> = ({\n                                        totalItemsCount,\n                                        pageSize,\n                                        currentPage,\n                                        portionSize = 15,\n                                        isLoading,\n                                        onPageChanged\n}) => {\n    const pagesCount = Math.ceil(totalItemsCount / pageSize) // count quantity of pages\n\n    // pagination\n    const portionCount = Math.ceil(pagesCount / portionSize)\n    const [portionNumber, setPortionNumber] = useState(1)\n    const leftPortionPageNumber = (portionNumber - 1) * portionSize + 1\n    const rightPortionPageNumber = portionNumber * portionSize\n\n    const pages = []\n    for (let i=1; i <= pagesCount; i++) {\n        pages.push(i)\n    }\n\n    return (\n        <div className={isLoading ? usersClasses.pagesLoading : usersClasses.pages}>\n            {portionNumber > 1 &&\n            <button\n                className={usersClasses.page}\n                onClick={ () => {setPortionNumber(portionNumber - 1)} }\n            >&lt;</button>\n            }\n\n            {pages\n                .filter(page => page >= leftPortionPageNumber && page <= rightPortionPageNumber)\n                .map(page => {\n                    return <div\n                        key={page}\n                        className={currentPage === page\n                            ? usersClasses.pageSelected\n                            : usersClasses.page }\n                        onClick={ () => {onPageChanged(page)} }\n                    >{page}</div>\n                })\n            }\n\n            {portionCount > portionNumber &&\n            <button\n                className={usersClasses.page}\n                onClick={ () => { setPortionNumber(portionNumber + 1)} }\n            >&gt;</button>\n            }\n        </div>\n    )\n}\n\nexport default Paginator\n","import React, {FC} from 'react'\nimport usersClasses from './users.module.css'\nimport {NavLink} from 'react-router-dom'\nimport avatar from '../../assets/img/unknownUser.jpeg'\nimport {UserType} from '../../types/types'\n\ntype PropsType = {\n    user: UserType\n    followingProgress: number[]\n    isLoading: boolean\n    follow: (userId: number) => void\n    unfollow: (userId: number) => void\n}\n\nconst User: FC<PropsType> = ({user, followingProgress, follow, unfollow, isLoading}) => {\n    return (\n        <div className={isLoading ? usersClasses.usersLoading : usersClasses.user}>\n\n            <div className={usersClasses.name}>\n                <h1>{user.name.toLowerCase()}</h1>\n            </div>\n\n            <div className={usersClasses.photo}>\n                <NavLink to={'/profile/' + user.id}>\n                    <img src={user.photos.large !== null ? user.photos.large : avatar} alt='User avatar'/>\n                </NavLink>\n            </div>\n\n            <div className={usersClasses.status}>\n                <h3>{user.status !== null ? user.status : 'There could be a status here, but...'}</h3>\n            </div>\n\n            <div className={usersClasses.button}>\n                {user.followed\n                    ? <button\n                        disabled={followingProgress.some(id => id === user.id)}\n                        onClick={() => {\n                            unfollow(user.id)\n                        }}\n                        className={usersClasses.followed}\n                    >Followed</button>\n\n                    : <button\n                        disabled={followingProgress.some(id => id === user.id)}\n                        onClick={() => {\n                            follow(user.id)\n                        }}\n                    >Follow</button>\n                }\n            </div>\n        </div>\n    )\n}\n\nexport default User\n","import {AppStateType} from '../store'\n\nexport const getUsersInfo = (state: AppStateType) => {\n    return state.usersPage.users\n}\n\nexport const getPageSize = (state: AppStateType) => {\n    return state.usersPage.pageSize\n}\n\nexport const getTotalUsersCount = (state: AppStateType) => {\n    return state.usersPage.totalUsersCount\n}\n\nexport const getCurrentPage = (state: AppStateType) => {\n    return state.usersPage.currentPage\n}\n\nexport const getIsLoading = (state: AppStateType) => {\n    return state.usersPage.isLoading\n}\n\nexport const getFollowingProgress = (state: AppStateType) => {\n    return state.usersPage.followingProgress\n}\n\nexport const getUsersFilter = (state: AppStateType) => {\n    return state.usersPage.filter\n}\n","import {Field, Form, Formik} from 'formik'\nimport React, {FC} from 'react'\nimport searchFormClasses from './searchform.module.css'\nimport {FilterType} from '../../redux/reducers/usersReducer'\nimport {useSelector} from 'react-redux'\nimport {getUsersFilter} from '../../redux/selectors/usersSelectors'\n\ntype PropsType = {\n\tonFilterChanged: (filter: FilterType) => void\n}\ntype FriendFormType = 'true' | 'false' | 'null'\ntype FormType = {\n\tterm: string\n\tfriend: FriendFormType\n}\n\n\nconst UsersSearchForm: FC<PropsType> = React.memo(({onFilterChanged}) => {\n\tconst filter = useSelector(getUsersFilter)\n\n\tconst submit = (values: FormType, {setSubmitting}: {setSubmitting: (isSubmitting: boolean) => void}) => {\n\t\tconst filter: FilterType = {\n\t\t\tterm: values.term,\n\t\t\tfriend: values.friend === 'null'\n\t\t\t\t? null\n\t\t\t\t: values.friend === 'true'\n\t\t\t\t\t? true\n\t\t\t\t\t: false\n\t\t}\n\t\tonFilterChanged(filter)\n\t\tsetSubmitting(false)\n\t}\n\n\treturn (\n\t\t<div className={searchFormClasses.form}>\n\t\t\t<Formik\n\t\t\t\tenableReinitialize\n\t\t\t\tinitialValues={{term: filter.term, friend: String(filter.friend) as FriendFormType}}\n\t\t\t\tonSubmit={submit}\n\t\t\t>\n\n\t\t\t{\n\t\t\t\t({isSubmitting}) => (\n\t\t\t\t\t<Form>\n\t\t\t\t\t\t<Field type='text' name='term' placeholder='Enter name' />\n\t\t\t\t\t\t<Field name='friend' as='select'>\n\t\t\t\t\t\t\t<option value='null'>All</option>\n\t\t\t\t\t\t\t<option value='true'>Only followed</option>\n\t\t\t\t\t\t\t<option value='false'>Only unfollowed</option>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<button type='submit' disabled={isSubmitting}>\n\t\t\t\t\t\t\tFind\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Form>\n\t\t\t\t)\n\t\t\t}\n\t\t\t</Formik>\n\t\t</div>\n\t)\n})\n\nexport default UsersSearchForm\n","import React, {FC, useEffect} from 'react'\nimport usersClasses from './users.module.css'\nimport Loading from '../common/loading/Loading'\nimport Paginator from '../common/paginator/Paginator'\nimport User from './User'\nimport UsersSearchForm from './UsersSearchForm'\nimport {FilterType, follow, getUsers, unfollow} from '../../redux/reducers/usersReducer'\nimport {useDispatch, useSelector} from 'react-redux'\nimport {\n    getCurrentPage,\n    getFollowingProgress,\n    getIsLoading,\n    getPageSize,\n    getTotalUsersCount,\n    getUsersFilter,\n    getUsersInfo\n} from '../../redux/selectors/usersSelectors'\nimport {useHistory} from 'react-router-dom'\nimport * as queryString from 'querystring'\n\ntype QueryParamsType = {\n    term?: string\n    page?: string\n    friend?: string\n}\n\nconst Users: FC = () => {\n    const users = useSelector(getUsersInfo)\n    const totalUsersCount = useSelector(getTotalUsersCount)\n    const currentPage = useSelector(getCurrentPage)\n    const pageSize = useSelector(getPageSize)\n    const isLoading = useSelector(getIsLoading)\n    const filter = useSelector(getUsersFilter)\n    const followingProgress = useSelector(getFollowingProgress)\n\n    const dispatch = useDispatch()\n    const history = useHistory()\n\n    useEffect(() => {\n        const parsed = queryString.parse(history.location.search.substr(1)) as QueryParamsType\n\n        let actualPage = currentPage\n        let actualFilter = filter\n\n        if (!!parsed.page) actualPage = Number(parsed.page)\n        if (!!parsed.term) actualFilter = {...actualFilter, term: parsed.term as string}\n\n        switch (parsed.friend) {\n            case 'null':\n                actualFilter = {...actualFilter, friend: null}\n                break\n            case 'true':\n                actualFilter = {...actualFilter, friend: true}\n                break\n            case 'false':\n                actualFilter = {...actualFilter, friend: false}\n                break\n        }\n\n        dispatch(getUsers(actualPage, pageSize, actualFilter))\n    }, [])\n\n    useEffect(() => {\n        const query: QueryParamsType = {}\n\n        if (!!filter.term) query.term = filter.term\n        if (filter.friend !== null) query.friend = String(filter.friend)\n        if (currentPage !== 1) query.page = String(currentPage)\n\n        history.push({\n            pathname: '/users',\n            search: queryString.stringify(query)\n        })\n    }, [filter, currentPage])\n\n    const followUser = (userId: number) => {\n        dispatch(follow(userId))\n    }\n\n    const unfollowUser = (userId: number) => {\n        dispatch(unfollow(userId))\n    }\n\n    const onPageChanged = (pageNumber: number) => {\n       dispatch(getUsers(pageNumber, pageSize, filter))\n    }\n\n    const onFilterChanged = (filter: FilterType) => {\n        dispatch(getUsers(1, pageSize, filter))\n    }\n\n    return (\n        <div className={usersClasses.inner}>\n            {isLoading ? <Loading /> : null}\n\n            <Paginator\n                totalItemsCount={totalUsersCount}\n                pageSize={pageSize}\n                currentPage={currentPage}\n                onPageChanged={onPageChanged}\n                isLoading={isLoading}\n            />\n\n            <UsersSearchForm onFilterChanged={onFilterChanged} />\n\n            {users.map(user => {\n                return <User\n                    key={user.id}\n                    user={user}\n                    followingProgress={followingProgress}\n                    follow={followUser}\n                    unfollow={unfollowUser}\n                    isLoading={isLoading}\n                />})\n            }\n        </div>\n    )\n}\n\nexport default Users\n"],"sourceRoot":""}